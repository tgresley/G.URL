<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Super Girl Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
  <style>
    body {
      margin: 0;
      background: #ffd8ec; /* soft pink */
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
    }
  </style>
</head><script>
  let num1, num2, operator, correctAnswer;
  let displayText = "";
  let currentQuestion = "";
  let input = "";
  let typingIndex = 0;
  let showingQuestion = true;
  let feedback = "";
  let lastAnswerCorrect = false;

  let sparkles = [];
  let hearts = [];

  function setup() {
    createCanvas(320, 500);
    textFont("Comic Sans MS");
    textSize(24);
    frameRate(30);
    newQuestion();
  }

  function draw() {
    background('#ffd8ec'); // soft pink

    // Sparkle particles
    drawSparkles();

    // Calculator frame
    noStroke();
    fill('#ff8acb');
    rect(20, 30, 280, 90, 20);

    // Display
    fill('#111');
    rect(30, 40, 260, 60, 12);

    // Display text
    fill('#98ff98');
    textAlign(LEFT, CENTER);
    textSize(22);
    if (showingQuestion) {
      if (typingIndex < currentQuestion.length) {
        displayText += currentQuestion[typingIndex];
        typingIndex++;
      }
      text(displayText, 40, 70);
    } else {
      text(input, 40, 70);
    }

    drawButtons();
    drawHearts();

    // Feedback
    if (feedback !== "") {
      textSize(18);
      textAlign(CENTER);
      fill(lastAnswerCorrect ? '#00cc66' : '#ff3366');
      text(feedback, width / 2, 460);
    }
  }

  function drawButtons() {
    const buttons = [
      ["7", "8", "9"],
      ["4", "5", "6"],
      ["1", "2", "3"],
      ["0", "←", "💘"]
    ];

    for (let row = 0; row < buttons.length; row++) {
      for (let col = 0; col < 3; col++) {
        const x = 30 + col * 90;
        const y = 140 + row * 70;
        stroke('#ff99cc');
        strokeWeight(2);
        fill('#ffe6f2');
        rect(x, y, 70, 60, 20);
        fill('#ff3399');
        noStroke();
        textAlign(CENTER, CENTER);
        textSize(24);
        text(buttons[row][col], x + 35, y + 30);
      }
    }
  }

  function mousePressed() {
    if (showingQuestion) return;

    const col = floor((mouseX - 30) / 90);
    const row = floor((mouseY - 140) / 70);

    if (col >= 0 && col < 3 && row >= 0 && row < 4) {
      const value = [
        ["7", "8", "9"],
        ["4", "5", "6"],
        ["1", "2", "3"],
        ["0", "←", "💘"]
      ][row][col];

      if (value === "←") {
        input = input.slice(0, -1);
      } else if (value === "💘") {
        checkAnswer();
      } else {
        input += value;
      }
    }
  }

  function checkAnswer() {
    if (parseInt(input) === correctAnswer) {
      feedback = "✨ Correct, girl! ✨";
      lastAnswerCorrect = true;
      for (let i = 0; i < 12; i++) {
        hearts.push({
          x: random(width),
          y: height / 2,
          size: random(20, 40),
          speed: random(1, 2)
        });
      }
      setTimeout(() => {
        newQuestion();
      }, 1200);
    } else {
      feedback = "🙅‍♀️ Nope, try again!";
      lastAnswerCorrect = false;
    }
  }

  function newQuestion() {
    num1 = floor(random(1, 10));
    num2 = floor(random(1, 10));
    operator = random(["+", "-"]);
    correctAnswer = operator === "+" ? num1 + num2 : num1 - num2;
    currentQuestion = `${num1} ${operator} ${num2} = `;
    input = "";
    displayText = "";
    typingIndex = 0;
    showingQuestion = true;
    feedback = "";

    setTimeout(() => {
      showingQuestion = false;
    }, currentQuestion.length * (4000 / 12));
  }

  function drawSparkles() {
    if (frameCount % 5 === 0) {
      sparkles.push({
        x: random(width),
        y: random(height / 2),
        r: random(2, 4),
        alpha: 255
      });
    }

    for (let i = sparkles.length - 1; i >= 0; i--) {
      const s = sparkles[i];
      fill(255, 255, 255, s.alpha);
      noStroke();
      ellipse(s.x, s.y, s.r * 2);
      s.alpha -= 3;
      if (s.alpha <= 0) sparkles.splice(i, 1);
    }
  }

  function drawHearts() {
    for (let i = hearts.length - 1; i >= 0; i--) {
      let h = hearts[i];
      fill('#ff66cc');
      noStroke();
      textSize(h.size);
      text("💖", h.x, h.y);
      h.y -= h.speed;
      h.size *= 0.98;
      if (h.y < -20 || h.size < 8) {
        hearts.splice(i, 1);
      }
    }
  }
</script>
